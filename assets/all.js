(function(){"use strict";var VERSION="1.0";var ORIGINAL=window.Class;var Class=window.Class=function(obj){obj=obj||{};var constructor=function(){return this.initialize?this.initialize.apply(this,arguments):self};if(obj.implement){var self=window===this?copy(constructor.prototype):this;var imp=obj.implement;remove(obj,"implement");obj=extend(obj,implement(imp))}constructor.prototype=copy(obj);constructor.constructor=constructor;constructor._parent=copy(obj);for(var i=0,values=["extend","implement","getOptions","setOptions"];i<values.length;i++){constructor[values[i]]=Class[values[i]]}return constructor};Class.extend=function(obj){var self=this;if(obj.implement){this.prototype=extend(this.prototype,implement(obj.implement));remove(obj,"implement")}for(var key in obj){obj[key]=typeof obj[key]==="function"&&/parent/.test(obj[key].toString())?function(method,name){return function(){this.parent=self._parent[name];return method.apply(this,arguments)}}(obj[key],key):obj[key]}this._parent=extend(this._parent,obj,true);this.prototype=extend(this.prototype,obj);return this};Class.implement=function(array){return this.prototype=extend(this.prototype,implement(array))};Class.getOptions=function(){return this.prototype.options||{}};Class.setOptions=function(options){return this.prototype.options=extend(this.prototype.options,options)};Class.noConflict=function(){window.Class=ORIGINAL;return Class};Class.version=VERSION;function copy(obj){var F=function(){};F.prototype=obj.prototype||obj;return new F}function remove(obj,name,safe){if(safe){var safeObj={};for(var key in obj){if(key!==name)safeObj[key]=obj[key]}}else{delete obj[name]}return safeObj||obj}function extend(oldObj,newObj,preserve){if(!oldObj||!newObj)return oldObj||newObj||{};oldObj=copy(oldObj);newObj=copy(newObj);for(var key in newObj){if(Object.prototype.toString.call(newObj[key])==="[object Object]"){extend(oldObj[key],newObj[key])}else{oldObj[key]=preserve&&oldObj[key]?oldObj[key]:newObj[key]}}return oldObj}function implement(array){var collection={};for(var i=0;i<array.length;i++){if(typeof array[i]==="function")array[i]=array[i].prototype;var safe=remove(array[i],"initialize",true);if(safe.implement){collection=implement(safe.implement)}else{collection=extend(collection,safe)}}return collection}})();var BlogView=new Class({options:{scrollBarWidth:40,scrollerLeftSelector:".scroller-left",scrollerRightSelector:".scroller-right",listSelector:".list",scrollSpeed:"slow",fadeSpeed:"slow",postContainerSelector:"#post"},container:null,leftScroller:null,rightScroller:null,list:null,width:null,url:null,data:{},initialize:function(container,options){$.extend(true,{},this.options,options);this.container=$(container);this.leftScroller=$(this.container).find(this.options.scrollerLeftSelector);this.rightScroller=$(this.container).find(this.options.scrollerRightSelector);this.list=$(this.container).find(this.options.listSelector);this.reAdjust();var firstPostUrl;this.list.find("li").each($.proxy(function(index,el){if(!firstPostUrl){firstPostUrl=$(el).find("a").attr("href")}$(el).find("a").click($.proxy(function(event){event.preventDefault();this.loadPost($(event.target).attr("href"))},this))},this));this.loadPost(firstPostUrl);this.list.find("li").each($.proxy(function(index,el){this.setThumbnailBackground(el)},this));$(window).on("resize",$.proxy(function(e){this.reAdjust()},this));this.rightScroller.click($.proxy(function(){this.scrollRight()},this));this.leftScroller.click($.proxy(function(){this.scrollLeft()},this))},scrollRight:function(){this.leftScroller.fadeIn(this.options.fadeSpeed);this.rightScroller.fadeOut(this.options.fadeSpeed);this.list.animate({left:"+="+this.getHiddenWidth()+"px"},this.options.scrollSpeed,function(){})},scrollLeft:function(){this.rightScroller.fadeIn(this.options.fadeSpeed);this.leftScroller.fadeOut(this.options.fadeSpeed);this.list.animate({left:"-="+this.getLeftPosition()+"px"},this.options.scrollSpeed,function(){})},getListWidth:function(){var itemsWidth=0;this.list.find("li").each(function(){var itemWidth=$(this).outerWidth();itemsWidth+=itemWidth});return itemsWidth},getHiddenWidth:function(){return this.container.outerWidth()-this.getListWidth()-this.getLeftPosition()-this.options.scrollBarWidth},getLeftPosition:function(){return this.list.position().left},reAdjust:function(){if(this.container.outerWidth()<this.getListWidth()){this.rightScroller.show()}else{this.rightScroller.hide()}if(this.getLeftPosition()<0){$(this.leftScroller).show()}else{this.leftScroller.hide()}},setThumbnailBackground:function(element){var self=this;$.ajax({url:$(element).find("a").attr("href"),context:element}).done(function(html){var body=$(html).find(self.options.postContainerSelector);var src=body.find("img").first().attr("src");if(src){$(this).find("a").css("background-image","url("+src+")")}})},loadPost:function(url){var self=this;$.ajax({url:url,context:$(this.options.postContainerSelector)}).done(function(html){var html=$(html).find(self.options.postContainerSelector).html();$(this).html(html)})}});$(window).load(function(){});function process_content(item){$(item).find(".blog-view").each(function(index,el){new BlogView(el)})}$(document).ready(function(){process_content($("body"))});